ø
Ž/Users/guilhermelyracampos/Documents/programacao/source/git/backend-challenge-pedidos/BackendChallenge.Pedidos.Infrastructure/PedidoContext.cs
	namespace 	
BackendChallenge
 
. 
Pedidos "
." #
Infrastructure# 1
{ 
public 

class 
PedidoContext 
:  
	DbContext! *
{ 
public 
PedidoContext 
( 
) 
{		 	
} 	
	protected 
override 
void 
OnConfiguring  -
(- .#
DbContextOptionsBuilder. E
optionsBuilderF T
)T U
{ 	
optionsBuilder 
. 
UseInMemoryDatabase .
(. /
databaseName/ ;
:; <
$str= O
)O P
;P Q
} 	
public 
PedidoContext 
( 
DbContextOptions -
<- .
PedidoContext. ;
>; <
options= D
)D E
:F G
baseH L
(L M
optionsM T
)T U
{ 	
} 	
	protected 
override 
void 
OnModelCreating  /
(/ 0
ModelBuilder0 <
modelBuilder= I
)I J
{ 	
var 
pedido 
= 
modelBuilder %
.% &
Entity& ,
<, -
Pedido- 3
>3 4
(4 5
)5 6
;6 7
pedido 
. 
HasKey 
( 
p 
=> 
p  
.  !
Id! #
)# $
;$ %
pedido 
. 
HasMany 
( 
i 
=> 
i  !
.! "
Itens" '
)' (
.( )
WithOne) 0
(0 1
p1 2
=>3 5
p6 7
.7 8
Pedido8 >
)> ?
;? @
var 
item 
= 
modelBuilder #
.# $
Entity$ *
<* +
Item+ /
>/ 0
(0 1
)1 2
;2 3
item 
. 
HasKey 
( 
p 
=> 
p 
. 
Id !
)! "
;" #
} 	
public   
DbSet   
<   
Pedido   
>   
Pedidos   $
{  % &
get  ' *
;  * +
set  , /
;  / 0
}  1 2
public!! 
DbSet!! 
<!! 
Item!! 
>!! 
Itens!!  
{!!! "
get!!# &
;!!& '
set!!( +
;!!+ ,
}!!- .
}"" 
}## Ë$
ž/Users/guilhermelyracampos/Documents/programacao/source/git/backend-challenge-pedidos/BackendChallenge.Pedidos.Infrastructure/Repositories/PedidoRepository.cs
	namespace		 	
BackendChallenge		
 
.		 
Pedidos		 "
.		" #
Infrastructure		# 1
.		1 2
Repositories		2 >
{

 
public 

class 
PedidoRepository !
:" #
IPedidoRepository$ 5
{ 
private 
readonly 
PedidoContext &
context' .
;. /
public 
PedidoRepository 
(  
PedidoContext  -
context. 5
)5 6
{ 	
this 
. 
context 
= 
context "
;" #
} 	
public 
async 
Task 
AdicionarAsync (
(( )
Pedido) /
pedido0 6
)6 7
{ 	
try 
{ 
await 
context 
. 
Pedidos %
.% &
AddAsync& .
(. /
pedido/ 5
)5 6
;6 7
await 
context 
. 
SaveChangesAsync .
(. /
)/ 0
;0 1
} 
catch 
( 
	Exception 
ex 
)  
{ 
Console 
. 
	WriteLine !
(! "
ex" $
.$ %
Message% ,
), -
;- .
} 
} 	
public!! 
async!! 
Task!! 
AtualizarAsync!! (
(!!( )
Pedido!!) /
pedido!!0 6
)!!6 7
{"" 	
context## 
.## 
Update## 
(## 
pedido## !
)##! "
;##" #
await$$ 
context$$ 
.$$ 
SaveChangesAsync$$ *
($$* +
)$$+ ,
;$$, -
}%% 	
public'' 
async'' 
Task'' 
<'' 
Pedido''  
>''  !
BuscarAsync''" -
(''- .
int''. 1
id''2 4
)''4 5
=>''6 8
await''9 >
context''? F
.''F G
Pedidos''G N
.''N O
Include''O V
(''V W
p''W X
=>''Y [
p''\ ]
.''] ^
Itens''^ c
)''c d
.''d e
FirstOrDefaultAsync''e x
(''x y
p''y z
=>''{ }
p''~ 
.	'' €
Id
''€ ‚
==
''ƒ …
id
''† ˆ
)
''ˆ ‰
;
''‰ Š
public)) 
async)) 
Task)) 
<)) 
IEnumerable)) %
<))% &
Pedido))& ,
>)), -
>))- .
ListarAsync))/ :
()): ;
))); <
=>))= ?
await))@ E
context))F M
.))M N
Pedidos))N U
.))U V
OrderBy))V ]
())] ^
p))^ _
=>))` b
p))c d
.))d e
DataCriacao))e p
)))p q
.))q r
ToArrayAsync))r ~
())~ 
)	)) €
;
))€ 
public++ 
async++ 
Task++ 
RemoverAsync++ &
(++& '
int++' *
id+++ -
)++- .
{,, 	
var-- 
pedido-- 
=-- 
context--  
.--  !
Pedidos--! (
.--( )
	FindAsync--) 2
(--2 3
id--3 5
)--5 6
.--6 7
Result--7 =
;--= >
context.. 
... 
Remove.. 
(.. 
pedido.. !
)..! "
;.." #
await// 
context// 
.// 
SaveChangesAsync// *
(//* +
)//+ ,
;//, -
}00 	
private22 
bool22 
disposedValue22 "
=22# $
false22% *
;22* +
	protected44 
virtual44 
void44 
Dispose44 &
(44& '
bool44' +
	disposing44, 5
)445 6
{55 	
if66 
(66 
!66 
disposedValue66 
)66 
{77 
disposedValue88 
=88 
true88  $
;88$ %
}99 
}:: 	
public<< 
void<< 
Dispose<< 
(<< 
)<< 
{== 	
Dispose>> 
(>> 
true>> 
)>> 
;>> 
}?? 	
}@@ 
}AA 